webpackJsonp([1],{"3nXc":function(e,s){},NHnr:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var n=t("MVMM"),a=t("Qx34"),i=t.n(a),o=(t("3cXf"),Math.random(),Math.random(),Math.random(),Math.PI,function(e,s){var t=Math.PI;if(0==e&&0==s)return"freeze";switch(e){case 0:switch(s){case 1:return t/2;case-1:return-t/2}break;case 1:switch(s){case 0:return 0;case 1:return t/4;case-1:return-t/4}break;case-1:switch(s){case 0:return t;case 1:return t/4*3;case-1:return-t/4*3}}}),r=t("6ROu"),l=t.n(r),c=t("lm8I"),h=t.n(c),p={scene:null,camera:null,renderer:null,me:null,mouseMove:null,mouseDown:null,mouseUp:null,keyDown:null,keyUp:null,init:function(){var e=this;this.me=this;var s=new THREE.Scene,t=new THREE.PerspectiveCamera(45,1.5,.1,1e4);t.position.y=80,t.position.x=-1e3,t.position.z=-1e3;var n=new THREE.WebGLRenderer;n.setSize(1200,800),n.setClearColor("#fff"),document.querySelector("#stage").appendChild(n.domElement),this.scene=s,this.camera=t,this.renderer=n,this.buildPlane();!function a(){setTimeout(a,18),e.animate(),n.render(s,t)}();var a=document.querySelector("canvas"),i=this;a&&(a.onmousedown=function(e){a.requestPointerLock(),document.pointerLockElement&&i.mouseDown(e)},a.onmouseup=function(e){document.pointerLockElement&&i.mouseUp(e)},a.onmousemove=function(e){document.pointerLockElement&&i.mouseMove(e.movementX,e.movementY)},document.onkeydown=function(e){document.pointerLockElement&&i.keyDown(e.key)},document.onkeyup=function(e){document.pointerLockElement&&i.keyUp(e.key)})},animate:function(){},buildPlane:function(){var e=new THREE.MeshBasicMaterial({color:"#ccc",side:THREE.DoubleSide}),s=new THREE.MeshBasicMaterial({color:"#804040",side:THREE.DoubleSide}),t=new THREE.MeshBasicMaterial({color:"#228E02",side:THREE.DoubleSide}),n=new THREE.PlaneGeometry(3e3,3e3,5,5),a=new THREE.Mesh(n,e);a.position.y=0,a.rotation.x=Math.PI/2,this.scene.add(a);for(var i=-10;i<10;i++)for(var o=-10;o<10;o++){var r=new THREE.PlaneGeometry(100,100,5,5),l=new THREE.Mesh(r,t);l.position.y=.2,l.position.x=100*i*2,l.position.z=100*o*2,l.rotation.x=Math.PI/2,this.scene.add(l)}var c=new THREE.PlaneGeometry(3e3,1e3,5,5),h=new THREE.Mesh(c,s);h.position.y=480,h.position.z=-1500,this.scene.add(h);var p=new THREE.PlaneGeometry(3e3,1e3,5,5),m=new THREE.Mesh(p,s);m.position.y=480,m.position.z=1500,this.scene.add(m);var u=new THREE.PlaneGeometry(3e3,1e3,5,5),d=new THREE.Mesh(u,s);d.position.y=480,d.position.x=1500,d.rotation.y=Math.PI/2,this.scene.add(d);var j=new THREE.PlaneGeometry(3e3,1e3,5,5),y=new THREE.Mesh(j,s);y.position.y=480,y.position.x=-1500,y.rotation.y=Math.PI/2,this.scene.add(y)},addPlayer:function(e,s){var t=new THREE.BoxGeometry(40,80,40),n=new THREE.MeshBasicMaterial({color:"#02a"}),a=new THREE.BoxGeometry(4,40,40),i=new THREE.MeshBasicMaterial({color:"#eee"}),o=new THREE.BoxGeometry(2,10,3),r=new THREE.BoxGeometry(2,10,3),l=new THREE.MeshBasicMaterial({color:"#222"}),c=new THREE.Mesh(t,n),h=new THREE.Mesh(a,i),p=new THREE.Mesh(o,l),m=new THREE.Mesh(r,l);c.position.y=40,h.position.y=60,h.position.x=22,p.position.y=65,p.position.x=24,p.position.z=-8,m.position.y=65,m.position.x=24,m.position.z=8;var u=new THREE.Group;return u.add(c),u.add(h),u.add(p),u.add(m),u.position.x=e,u.position.z=s,this.scene.add(u),u},addLookObj:function(){},movePlayer:function(e,s,t){e.position.x=s,e.position.z=t}},m={data:function(){return{ws:null,playerId:null,playerName:null,isStarted:!1,stage:null,angel:0,angelH:0,speed:0,speedSide:0,speedSize:4,lastFrameTime:0,diff:0,players:{},balls:{},frames:0}},computed:{moveAngel:function(){return o(this.speed,this.speedSide)}},methods:{str:function(e){return h.a.stringify(e)},parse:function(e){return h.a.parse(e)},onopen:function(e){this.ws.send("open");this.playerId,this.playerName},onmessage:function(e){var s=null;try{s=this.parse(e.data)}catch(e){}if(s&&"commitPlayer"===s.type&&s.playerId!==this.playerId)if(this.players[s.playerId]||(this.players[s.playerId]=s),this.players[s.playerId].obj){var t=this.players[s.playerId].obj;t.position.x=s.x,t.position.z=s.z,t.rotation.y=s.angel,this.players[s.playerId]=s,this.players[s.playerId].obj=t}else{var n=p.addPlayer(s.x,s.z);this.players[s.playerId].obj=n}},onclose:function(e){console.log(e)},onerror:function(e){console.log(e)},moveSpeed:function(e){return e*this.diff/16},playerMove:function(){"freeze"!=this.moveAngel&&(p.camera.position.x+=this.moveSpeed(this.speedSize)*Math.cos(this.angel+this.moveAngel),p.camera.position.z+=this.moveSpeed(this.speedSize)*Math.sin(this.angel+this.moveAngel),p.camera.position.x>1480&&(p.camera.position.x=1480),p.camera.position.x<-1480&&(p.camera.position.x=-1480),p.camera.position.z>1480&&(p.camera.position.z=1480),p.camera.position.z<-1480&&(p.camera.position.z=-1480))},animate:function(){this.frames++,this.frames>1e5&&(this.frames=0);var e={type:"commitPlayer",playerId:this.playerId,x:p.camera.position.x,z:p.camera.position.z,angel:-this.angel};this.ws.send(this.str(e));var s=l()().valueOf();this.diff=s-this.lastFrameTime,this.lastFrameTime=s,this.playerMove()},mouseMove:function(e,s){this.angel+=e/500,(this.angel>=2*Math.PI||this.angel<=2*-Math.PI)&&(this.angel=0),this.angelH+=-s/500,this.angelH>=Math.PI/2-.1&&(this.angelH=Math.PI/2-.1),this.angelH<=-Math.PI/2+.1&&(this.angelH=-Math.PI/2+.1);var t=1e3*Math.sin(this.angelH),n=1e3*Math.cos(this.angelH),a=n*Math.cos(this.angel)+p.camera.position.x,i=n*Math.sin(this.angel)+p.camera.position.z;p.camera.lookAt(a,t,i)},mouseDown:function(){},mouseUp:function(){},keyDown:function(e){switch(e){case"w":this.speed=1;break;case"s":this.speed=-1;break;case"d":this.speedSide=1;break;case"a":this.speedSide=-1}},keyUp:function(e){switch(e){case"w":case"s":this.speed=0;break;case"d":1===this.speedSide&&(this.speedSide=0);break;case"a":-1===this.speedSide&&(this.speedSide=0)}},start:function(){this.playerName?(localStorage.setItem("playerName",this.playerName),this.playerId||(this.playerId=i.a.v4(),localStorage.setItem("playerId",this.playerId)),this.ws=new WebSocket("ws://192.168.0.104:8080"),this.ws.onopen=this.onopen,this.ws.onmessage=this.onmessage,this.ws.onclose=this.onclose,this.ws.onerror=this.onerror,p.animate=this.animate,this.isStarted=!0):alert("请输入大名。111")}},beforeDestroy:function(){this.ws=null},mounted:function(){document.pointerLockElement,this.playerName=localStorage.getItem("playerName"),this.playerId=localStorage.getItem("playerId"),p.mouseMove=this.mouseMove,p.mouseDown=this.mouseDown,p.mouseUp=this.mouseUp,p.keyDown=this.keyDown,p.keyUp=this.keyUp,p.init(),this.start()}},u={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"title"},[e._v("DXZ")]),e._v(" "),t("div",{staticClass:"stage",attrs:{id:"stage"}}),e._v(" "),e.isStarted?e._e():t("div",{staticClass:"login"},[t("div",{staticClass:"login__box"},[t("span",[e._v("大名：")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.playerName,expression:"playerName"}],staticStyle:{"font-size":"26px",width:"200px"},attrs:{type:"text"},domProps:{value:e.playerName},on:{input:function(s){s.target.composing||(e.playerName=s.target.value)}}}),e._v(" "),t("div",{staticStyle:{width:"20px"}}),e._v(" "),t("button",{on:{click:e.start}},[e._v("开始")])])]),e._v(" "),t("div",[e._v(e._s(e.players))])])},staticRenderFns:[]};var d=t("vSla")(m,u,!1,function(e){t("3nXc")},null,null).exports;n.a.config.productionTip=!1,new n.a({el:"#app",components:{App:d},template:"<App/>"})},pFZ8:function(e,s,t){var n={"./af":"nqC2","./af.js":"nqC2","./ar":"tHRT","./ar-dz":"2iw2","./ar-dz.js":"2iw2","./ar-kw":"soBb","./ar-kw.js":"soBb","./ar-ly":"zjQ3","./ar-ly.js":"zjQ3","./ar-ma":"11uP","./ar-ma.js":"11uP","./ar-sa":"yM2J","./ar-sa.js":"yM2J","./ar-tn":"k9UU","./ar-tn.js":"k9UU","./ar.js":"tHRT","./az":"H/ZR","./az.js":"H/ZR","./be":"NcWj","./be.js":"NcWj","./bg":"ux43","./bg.js":"ux43","./bm":"SHxi","./bm.js":"SHxi","./bn":"mhJc","./bn.js":"mhJc","./bo":"LyiZ","./bo.js":"LyiZ","./br":"eXAx","./br.js":"eXAx","./bs":"e6JA","./bs.js":"e6JA","./ca":"Nq9b","./ca.js":"Nq9b","./cs":"UHZy","./cs.js":"UHZy","./cv":"A9HL","./cv.js":"A9HL","./cy":"VZG9","./cy.js":"VZG9","./da":"ucoA","./da.js":"ucoA","./de":"crTT","./de-at":"Tz0t","./de-at.js":"Tz0t","./de-ch":"thUw","./de-ch.js":"thUw","./de.js":"crTT","./dv":"3FyJ","./dv.js":"3FyJ","./el":"soCQ","./el.js":"soCQ","./en-au":"dDC6","./en-au.js":"dDC6","./en-ca":"a+lM","./en-ca.js":"a+lM","./en-gb":"M9nR","./en-gb.js":"M9nR","./en-ie":"Mg3b","./en-ie.js":"Mg3b","./en-il":"FnyN","./en-il.js":"FnyN","./en-nz":"k7mD","./en-nz.js":"k7mD","./eo":"jXmb","./eo.js":"jXmb","./es":"6C4d","./es-do":"obsI","./es-do.js":"obsI","./es-us":"6PAY","./es-us.js":"6PAY","./es.js":"6C4d","./et":"vuD1","./et.js":"vuD1","./eu":"u5y6","./eu.js":"u5y6","./fa":"tFrz","./fa.js":"tFrz","./fi":"X+Ax","./fi.js":"X+Ax","./fo":"Rh5s","./fo.js":"Rh5s","./fr":"TOjj","./fr-ca":"ruqB","./fr-ca.js":"ruqB","./fr-ch":"00Y2","./fr-ch.js":"00Y2","./fr.js":"TOjj","./fy":"SRJb","./fy.js":"SRJb","./gd":"0IH4","./gd.js":"0IH4","./gl":"xKUt","./gl.js":"xKUt","./gom-latn":"mXUA","./gom-latn.js":"mXUA","./gu":"KJ90","./gu.js":"KJ90","./he":"Lb8N","./he.js":"Lb8N","./hi":"zKrU","./hi.js":"zKrU","./hr":"c7Tt","./hr.js":"c7Tt","./hu":"nPYQ","./hu.js":"nPYQ","./hy-am":"xP+R","./hy-am.js":"xP+R","./id":"b/5h","./id.js":"b/5h","./is":"NBPu","./is.js":"NBPu","./it":"j638","./it.js":"j638","./ja":"+4ei","./ja.js":"+4ei","./jv":"zTBq","./jv.js":"zTBq","./ka":"0yQz","./ka.js":"0yQz","./kk":"bHch","./kk.js":"bHch","./km":"WKL0","./km.js":"WKL0","./kn":"3YHI","./kn.js":"3YHI","./ko":"Q+Dq","./ko.js":"Q+Dq","./ky":"CcNt","./ky.js":"CcNt","./lb":"M5Vs","./lb.js":"M5Vs","./lo":"o/Sk","./lo.js":"o/Sk","./lt":"cLY9","./lt.js":"cLY9","./lv":"RGDN","./lv.js":"RGDN","./me":"FD3J","./me.js":"FD3J","./mi":"GwqZ","./mi.js":"GwqZ","./mk":"uQI5","./mk.js":"uQI5","./ml":"T6pu","./ml.js":"T6pu","./mn":"yxpo","./mn.js":"yxpo","./mr":"bPiS","./mr.js":"bPiS","./ms":"2OOo","./ms-my":"KSMX","./ms-my.js":"KSMX","./ms.js":"2OOo","./mt":"Nh9e","./mt.js":"Nh9e","./my":"/XOG","./my.js":"/XOG","./nb":"Ae3M","./nb.js":"Ae3M","./ne":"I2Mq","./ne.js":"I2Mq","./nl":"q8N+","./nl-be":"iNpx","./nl-be.js":"iNpx","./nl.js":"q8N+","./nn":"i67k","./nn.js":"i67k","./pa-in":"adWD","./pa-in.js":"adWD","./pl":"+rcL","./pl.js":"+rcL","./pt":"oklR","./pt-br":"gJMY","./pt-br.js":"gJMY","./pt.js":"oklR","./ro":"sk37","./ro.js":"sk37","./ru":"+4Xv","./ru.js":"+4Xv","./sd":"Jt7/","./sd.js":"Jt7/","./se":"oN7S","./se.js":"oN7S","./si":"+QYi","./si.js":"+QYi","./sk":"egU1","./sk.js":"egU1","./sl":"aGJs","./sl.js":"aGJs","./sq":"GtSw","./sq.js":"GtSw","./sr":"KvrN","./sr-cyrl":"maSq","./sr-cyrl.js":"maSq","./sr.js":"KvrN","./ss":"rkEC","./ss.js":"rkEC","./sv":"goqJ","./sv.js":"goqJ","./sw":"C+kv","./sw.js":"C+kv","./ta":"fqly","./ta.js":"fqly","./te":"E4H0","./te.js":"E4H0","./tet":"/++u","./tet.js":"/++u","./tg":"Hw/J","./tg.js":"Hw/J","./th":"OxV8","./th.js":"OxV8","./tl-ph":"26rn","./tl-ph.js":"26rn","./tlh":"ZWUx","./tlh.js":"ZWUx","./tr":"Ygbz","./tr.js":"Ygbz","./tzl":"cYDi","./tzl.js":"cYDi","./tzm":"RfCZ","./tzm-latn":"ZY5v","./tzm-latn.js":"ZY5v","./tzm.js":"RfCZ","./ug-cn":"2gWI","./ug-cn.js":"2gWI","./uk":"II8x","./uk.js":"II8x","./ur":"CREB","./ur.js":"CREB","./uz":"G9HU","./uz-latn":"Swdd","./uz-latn.js":"Swdd","./uz.js":"G9HU","./vi":"gkPr","./vi.js":"gkPr","./x-pseudo":"9yAS","./x-pseudo.js":"9yAS","./yo":"3Xqy","./yo.js":"3Xqy","./zh-cn":"HZyc","./zh-cn.js":"HZyc","./zh-hk":"ITl9","./zh-hk.js":"ITl9","./zh-tw":"RXqC","./zh-tw.js":"RXqC"};function a(e){return t(i(e))}function i(e){var s=n[e];if(!(s+1))throw new Error("Cannot find module '"+e+"'.");return s}a.keys=function(){return Object.keys(n)},a.resolve=i,e.exports=a,a.id="pFZ8"}},["NHnr"]);
//# sourceMappingURL=app.3073c8373e92e4606537.js.map